# =================================
# Pikabu Download Bot - Production
# External PostgreSQL Database
# =================================
#
# Используйте этот файл, если PostgreSQL уже запущен
# на сервере или на отдельном DB сервере
#
# ВАЖНО: После редактирования выполните: chmod 600 .env

# =================================
# TELEGRAM BOT (ОБЯЗАТЕЛЬНО!)
# =================================
BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
BOT_USERNAME=YourBotUsername

# =================================
# ADMIN (ОБЯЗАТЕЛЬНО!)
# =================================
ADMIN_USER_ID=123456789
ADMIN_ENABLE_NOTIFICATIONS=true
ADMIN_ENABLE_DAILY_DIGEST=false
ADMIN_ENABLE_WEEKLY_DIGEST=false

# =================================
# APPLICATION
# =================================
SERVER_PORT=8080
APP_MAX_CONCURRENT_DOWNLOADS=5
APP_RATE_LIMIT_MAX_REQUESTS=1000
APP_RATE_LIMIT_WINDOW_HOURS=1

# =================================
# LOGGING
# =================================
# Уровни логирования: TRACE, DEBUG, INFO, WARN, ERROR, OFF
# Для отладки установите DEBUG, для прода - INFO
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_APP=INFO
LOGGING_LEVEL_PARSER=INFO
LOGGING_LEVEL_DOWNLOAD=INFO
LOGGING_LEVEL_QUEUE=INFO

# Настройки ротации логов
LOGGING_FILE_PATH=./logs/pikabu-bot.log
LOGGING_MAX_FILE_SIZE=100MB
LOGGING_MAX_HISTORY=30
LOGGING_TOTAL_SIZE_CAP=3GB

# =================================
# PIKABU AUTHENTICATION (ОПЦИОНАЛЬНО)
# =================================
# Для скачивания видео доступных только авторизованным пользователям
#
# Можно оставить пустым и использовать команду /update_auth в боте
# для обновления cookies без перезапуска
#
# Или указать cookies здесь:
# 1. Откройте pikabu.ru в браузере и авторизуйтесь
# 2. Нажмите F12 → Application → Cookies → https://pikabu.ru
# 3. Найдите cookie PHPSESS (основная для авторизации)
# 4. Скопируйте в формате: PHPSESS=значение
#
# Пример: PIKABU_AUTH_COOKIES="PHPSESS=abc123def456"
#
PIKABU_AUTH_ENABLED=false
PIKABU_AUTH_COOKIES=

# =================================
# EXTERNAL DATABASE CONNECTION
# =================================
# ВАЖНО: Настройте подключение к вашей PostgreSQL БД

# Вариант 1: PostgreSQL на том же сервере (localhost)
# Если используете network_mode: host в docker-compose
# ВАЖНО: currentSchema=pikabu_bot явно указывает схему!
SPRING_DATASOURCE_URL=jdbc:postgresql://localhost:5432/pikabu_bot?currentSchema=pikabu_bot

# Вариант 2: PostgreSQL на другом хосте
# SPRING_DATASOURCE_URL=jdbc:postgresql://db-server.example.com:5432/pikabu_bot?currentSchema=pikabu_bot

# Вариант 3: PostgreSQL по IP адресу
# SPRING_DATASOURCE_URL=jdbc:postgresql://10.0.1.100:5432/pikabu_bot?currentSchema=pikabu_bot

# Credentials для БД
SPRING_DATASOURCE_USERNAME=pikabu_user
SPRING_DATASOURCE_PASSWORD=your_database_password

# =================================
# ПОДГОТОВКА БАЗЫ ДАННЫХ
# =================================
#
# Перед запуском создайте БД, схему и пользователя:
#
# sudo -u postgres psql << 'EOF'
# CREATE DATABASE pikabu_bot;
# \c pikabu_bot
# CREATE USER pikabu_user WITH PASSWORD 'your_database_password';
# CREATE SCHEMA IF NOT EXISTS pikabu_bot;
# GRANT ALL PRIVILEGES ON DATABASE pikabu_bot TO pikabu_user;
# GRANT ALL ON SCHEMA pikabu_bot TO pikabu_user;
# ALTER DEFAULT PRIVILEGES IN SCHEMA pikabu_bot GRANT ALL ON TABLES TO pikabu_user;
# ALTER DEFAULT PRIVILEGES IN SCHEMA pikabu_bot GRANT ALL ON SEQUENCES TO pikabu_user;
# EOF
#
# ВАЖНО: Используется схема pikabu_bot, НЕ public!
# Миграции Liquibase применятся автоматически при старте!

# =================================
# NETWORK NOTES
# =================================
#
# Если PostgreSQL на localhost:
# 1. Раскомментируйте network_mode: "host" в docker-compose.yml
# 2. Используйте localhost в SPRING_DATASOURCE_URL
#
# Если PostgreSQL на другом хосте:
# 1. Используйте IP или hostname в SPRING_DATASOURCE_URL
# 2. Убедитесь что PostgreSQL разрешает внешние подключения
#    (postgresql.conf: listen_addresses = '*')
# 3. Настройте pg_hba.conf для доступа с IP Docker контейнера
